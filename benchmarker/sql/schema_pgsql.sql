-- benchmarker/userdata/load_pgsql.rbから読み込まれる

DROP TABLE IF EXISTS users;
CREATE TABLE users (
  id integer GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  account_name varchar(64) NOT NULL UNIQUE,
  passhash varchar(128) NOT NULL, -- SHA2 512 non-binary (hex)
  authority smallint NOT NULL DEFAULT 0,
  del_flg smallint NOT NULL DEFAULT 0,
  created_at timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP
);

DROP TABLE IF EXISTS posts;
CREATE TABLE posts (
  id integer GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  user_id integer NOT NULL,
  mime varchar(64) NOT NULL,
  imgdata bytea NOT NULL,
  body text NOT NULL,
  created_at timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP
);

DROP TABLE IF EXISTS comments;
CREATE TABLE comments (
  id integer GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  post_id integer NOT NULL,
  user_id integer NOT NULL,
  comment text NOT NULL,
  created_at timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP
);
